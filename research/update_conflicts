% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
consistency: how does git work?

Areas
  A   focused old Area
  Ai  other old Areas
  Bi  new Area(s)
  Ti  temporary Area(s) inserted before

Conflicts
  A)  automatic resolution (one obvious solution)
  S)  semi-automatic resolution (two definite alternatives)
  M)  manual resolution (empty land, obvious conflicts)


NCH
---

A ---O--- A

next operation to A
  id:   no possible conflict
  terr: no possible conflict
  name: possible conflict

  UNI -> A ceases
A)    => A: update \texttt{name} in \texttt{OldArea}

  SEP -> A ceases
A)    => A: update \texttt{name} in \texttt{OldArea}

  INC -> A updates only territory, not name
      => A: no conflict

  SEC -> A updates only territory, not name
      => A: no conflict

  NCH -> A can still be renamed
A)    -> A: update \texttt{old\_name} in \texttt{UpdateArea}


INC
---

T----|
A ---O--- A

next operation to A
  id:   no possible conflict
  terr: possible conflict
  name: no possible conflict

  UNI -> A cedes in UNI with larger territory
A)    => A: update \texttt{territory} in \texttt{OldArea}
A)    => B: update \texttt{territory} in \texttt{NewArea}
        => recursive update (treat as INC)

  SEP -> A separated in SEP with larger territory into Bi, but what about the rest of the larger territory?
      => Bi: keep as they are
A)    => A: separate into Bi, but for rest: empty land
M)      => CONFLICT! need to be resolved manually

  INC -> A incorporates B with larger territory
A)    => A: update \texttt{old\_territory} and \texttt{new\_territory} in \texttt{UpdateArea}
        => recursive update (treat as INC)

  SEC -> A cedes Bi in SEC with larger territory, T was not part of A before, will not be part of Bi now
A)    => A: update \texttt{old\_territory} and \texttt{new\_territory} in \texttt{UpdateArea}
        => recursive update (treat as INC)

  NCH -> A updates only name, not territory
      => no conflict


SEC
---

A ---O--- A
     |--- T

next operation to A
  id:   no possible conflict
  terr: possible conflict
  name: no possible conflict

  UNI -> A ceases, Ti not directly involved in UNI, but its territory
A)    => A: update \texttt{territory} in \texttt{OldArea}
S)    => CONFLICT! a) keep T or b) UNI together with Ai to B?
      -> if a)
-> A)   B: subtract Ti from \texttt{territory} in \texttt{NewArea}
          => recursive update (treat as SEC)
      -> if b)
-> A)   for each Ti: add to \texttt{OldArea}

  SEP -> A ceases into Bi but Ti covers territory of Bi in Ti
      => Bi: territory that is not covered by Ti: keep for now
S)    => CONFLICT! territory that is covered by Ti: a) keep Ti or b) keep Bi?
      -> if a)
-> A)   update \texttt{territory} of A in \texttt{OldArea}
        update \texttt{territory} of Bi in \texttt{NewArea}
        => recursive update (treat as SEC)
      -> if b)
-> A)   Hivent UNI A with Ti to Ts (simultaneous) before SEP
        replace \texttt{area} A by Ts in \texttt{OldArea}


  INC -> territory of A enlarges, Ti not directly involved in INC, but its territory
A)    => A: update \texttt{old\_territory} in \texttt{UpdateArea}
S)    => CONFLICT! a) keep Ti or b) INC together with Ai into A?
      -> if a)
-> A)   A: update \texttt{new\_territory} in \texttt{UpdateArea}
          => recursive update (treat as SEC)
      -> if b)
-> A)   for each Ti: add to \texttt{OldArea}

  SEC -> territory of A shrinks, Bi gets seceded, but covered by T
      => Bi: territory that is not covered by T: keep for now
S)    => CONFLICT! territory that is covered by Ti: a) keep Ti or b) keep Bi?
      -> if a)
-> A)   A: update \texttt{old\_territory} in \texttt{UpdateArea}
        A: update \texttt{new\_territory} in \texttt{UpdateArea}
          => recursive update (treat as SEC)
        Bi: update \texttt{territory} in \texttt{NewArea}
          => recursive update (treat as SEC)
      -> if b)
-> A)   add Hivent Operation INC of Ti into A before SEC

  NCH -> A updates only name, not territory
      => no conflict


UNI
---

A ---|
     O--- T
B ---|

next operation to A
  id:   possible conflict
  terr: possible conflict
  name: no possible conflict

  UNI -> A does not exist anymore to be unified, but can be be replaced by T
A)     => T: replace \texttt{area} A by T in \texttt{OldArea}
A)     => B: update \texttt{territory} in \texttt{NewArea}
        => recursive update of territory of B (treat as INC)

  SEP -> A does not exist anymore to be separated. If A is replaced by T in SEP, Bi get created, but what about the rest of the larger territory?
A)    => T: replace \texttt{area} A by T in \texttt{OldArea}
      => Bi: keep as they are
      => rest of T not covered by Bi: empty land
M)     => CONFLICT! need to be resolved manually

  INC -> A does not exist anymore to incorporate B, but can be replaced by T
A)    => T: replace \texttt{area} A by T in \texttt{UpdateArea},
          update \texttt{old\_territory} and \texttt{new\_territory}
        => recursive update of area A to T and territory (treat as UNI)

  SEC -> A does not exist anymore to secede Bi, but can be replaced by T in SEC
A)    => T: replace \texttt{area} A by T in \texttt{UpdateArea},
          update \texttt{old\_territory} and \texttt{new\_territory}
        => recursive update of area A to T and territory (treat as UNI)

  NCH -> A does not exist anymore to be renamed
A)    => delete NCH operation


SEP
---

     |--- T1
A ---O
     |--- T2

next operation to A
  id:   possible conflict
  terr: possible conflict
  name: no possible conflict

  UNI -> A does not exist anymore to be unified. Ti occupy exactly the same territory as A before.
      => a) keep Ti or b) UNI with Ai to B?
S)      => CONFLICT: need to be resolved by decision
        -> if a)
          => Ti: remove Ti from UNI
-> A)        B: update \texttt{territory} of B in \texttt{newArea}
              => recursively update territory of B (treat as SEC)
        -> if b)
-> A)     => Ti: for each Ti replace \texttt{area} A by Ti in \texttt{OldArea}

  SEP -> A does not exist anymore to be separated. Ti occupy exactly the same territory as A before that separated to Bi
S)    => CONFLICT! a) use Ti or b) use Bi?
        -> if a)
-> A)     remove SEP operation
        -> if b)
-> A)     add operation UNI of Ti to Ts (simultaneous) before SEP
          replace \texttt{area} A by Ts in \texttt{OldArea}

  INC -> A does not exist anymore to incorporate B. It is impossible to say if B should be incorporated into Ti
M)    => CONFLICT! need to be manually resolved

  SEC -> A does not exist anymore to secede from. T1 and T2 occupy exactly the same territory as A before
S)    => CONFLICT! a) keep Ti) or b) keep Bi
      -> if a)
-> A)    remove INC operation
      -> if b)
        it is impossible to say where Bi should secede from, since A does not exist anymore
-> M)    => CONFLICT! needs to be resolved manually

      -> secede both from T1 and T2, unify to new Area

  NCH -> A does not exist anymore to be renamed
A)    => delete NCH operation
